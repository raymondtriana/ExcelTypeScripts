{"version":"0.2.0","body":"/*\nAUTHOR: Raymond Levi Triana\nDATE: 11/2/22\nUPDATE: 6/8/23\nUPDATE PURPOSE: Accomodate Riviera's demands on renaming Transportation\nPURPOSE: clears the doorsheet automatically at 10AM and re-pastes formulas back in\nWORKBOOK: DOOR SHEET.xlsx */\n\nvar rt_nums:(string|number|boolean)[][] = new Array()\n\nfunction main(workbook: ExcelScript.Workbook) {\n    // Your code here\n  workbook.getWorksheet(\"Ending Sheet\").getProtection().unprotect()\n\n  clear_workbook(workbook)\n\n  workbook.getWorksheet(\"Ending Sheet\").getProtection().protect()\n}\n\nfunction clear_workbook(workbook:ExcelScript.Workbook){\n  var today: Date = new Date(Date.now())\n  var tomorrow: Date = new Date()\n  tomorrow.setDate(today.getDate()+1)\n  var worksheet = workbook.getWorksheet(\"Ending Sheet\")\n  var table = worksheet.getTable(\"DoorSheetTable\")\n  var range = table.getRangeBetweenHeaderAndTotal()\n\n  table.clearFilters()\n  //update date\n  worksheet.getCell(0, 11).setValue(tomorrow.toDateString())\n\n\n  //init rt_nums\n\n  for(var i = 0; i<256;i++){\n    rt_nums.push(new Array())\n    rt_nums[i].push((((today.getDay()+1) * 1000) + i).toString())\n  }\n\n  range = table.getRangeBetweenHeaderAndTotal()\n  range.clear(ExcelScript.ClearApplyTo.contents)\n\n  var formulas:(string|number|boolean)[][] = new Array()\n  //formulas.push(new Array(23))\n  formulas.push(new Array(34))\n  for(var i = 0; i < formulas[0].length; i++){\n    if(i==7){//SHTL\n      formulas[0][i] = \"=IFERROR(LET(link,'https://cheneybrothers.sharepoint.com/sites/TransportationOCL-Shared/Shared Documents/Door Sheet/[Security CheckPoint.xlsx]Buffer'!D1,IF(link<>0,link,\\\"\\\")),\\\" \\\")\"\n      continue\n    }\n    if(i==8){//Truck Tractor\n      formulas[0][i] = \"=IFERROR(LET(link,'https://cheneybrothers.sharepoint.com/sites/TransportationOCL-Shared/Shared Documents/Door Sheet/[Security CheckPoint.xlsx]Buffer'!B1,IF(link<>0,link,\\\"\\\")),\\\" \\\")\"\n      continue\n    }\n    if(i==11){//trailer#\n      formulas[0][i] = \"=IF($W4<>0,$W4,\\\"\\\")\"\n      continue\n    }\n    if(i==12){//DR\n      formulas[0][i] = \"=IF($X4<>0,$X4,\\\"\\\")\"\n      continue\n    }\n    if(i==20){//RTE_C\n      formulas[0][i]=\"=$A4\"\n      continue\n    }\n    if(i > 20 && i!=24){\n      formulas[0][i]=\" \"\n      continue\n    }\n    if(i == 24){\n      formulas[0][i] = \"=IFERROR(INDEX(Loader!$A$1:$N$9999,MATCH(Y4,Loader!A:A,0),2),\\\"\\\")\"\n      continue\n    }\n    if(i==18){\n      formulas[0][i] = \"=IFERROR(LET(link,'https://cheneybrothers.sharepoint.com/sites/TransportationOCL-Shared/Shared Documents/Door Sheet/[Security CheckPoint.xlsx]Buffer'!E1,IF(link<>0,link,\\\"\\\")),\\\" \\\")\"\n      continue\n    }\n    if (i == 19) {\n      formulas[0][i] = \"=IFERROR(LET(link,'https://cheneybrothers.sharepoint.com/sites/TransportationOCL-Shared/Shared Documents/Door Sheet/[Security CheckPoint.xlsx]Buffer'!C1,IF(link<>0,link,\\\"\\\")),\\\" \\\")\"\n      continue\n    }\n    formulas[0][i] = \"=IFERROR(LET(link,'https://cheneybrothers.sharepoint.com/sites/TransportationOCL-Shared/Shared Documents/Door Sheet/[ROUTINGDOOR.xlsx]Ending Sheet'!$A$1:$X$9999,searchArea,'https://cheneybrothers.sharepoint.com/sites/TransportationOCL-Shared/Shared Documents/Door Sheet/[ROUTINGDOOR.xlsx]Ending Sheet'!$A:$A,index,\" + (i + 2).toString() + \",IF(INDEX(link, MATCH($A4, searchArea, 0), index)<>0,INDEX(link, MATCH($A4, searchArea, 0), index),\\\"\\\")), \\\" \\\")\" \n  }\n\n  worksheet.getRange(\"B4:AI4\").setValues(formulas)\n  \n  table.resize(\"A3:AI4\")\n  table.resize(\"A3:AI259\")\n\n  range = table.getRangeBetweenHeaderAndTotal()\n  range.getColumn(0).setValues(rt_nums)\n  console.log(rt_nums)\n}\n","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}