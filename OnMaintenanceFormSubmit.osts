{"version":"0.2.0","body":"/*\nAUTHOR: Raymond Levi Triana\nPURPOSE: A callback script executed by powerautomate whenever a new form entry is submitted\nDATE: 10/10/2022\nWORKBOOK: Maintenance Request\n*/\nvar databaseTable:ExcelScript.Table = null\nfunction main(workbook: ExcelScript.Workbook) {\n    // Your code here\n   //workbook.getWorksheet(\"Interface\").getCell(0,10).setValue(\"ON_SUBMIT\")//Test code\n/*\n  databaseTable = workbook.getWorksheet(\"Database\").getTable(\"table1\")\n  sortByID()\n  clearCompletion()\n  sortBySeverity()*/\n}\n\nfunction clearCompletion() {\n  /*Searches the Database for the row according to its ID and caches it*/\n  let tableRange = databaseTable.getRangeBetweenHeaderAndTotal()\n  var target_row = tableRange.getLastRow()\n  var submit_time = target_row.getCell(0, 2).getValue()\n  target_row.getCell(0,1).setValue( submit_time )\n  target_row.getCell(0,2).setValue(\"\")\n}\n\nfunction sortByID(){\n  let ascNumSort: ExcelScript.SortField = {\n    ascending: true,\n    color: \"000000\",\n    key: 0,\n    sortOn: ExcelScript.SortOn.value\n  }\n  databaseTable.getSort().apply([ascNumSort])//apply an ascending value sort to column 'ID'\n}\n\nfunction sortBySeverity(){\n  let severitySort: ExcelScript.SortField = {\n    ascending: false,\n    color: \"000000\",\n    key: 7,\n    dataOption: ExcelScript.SortDataOption.textAsNumber,\n    sortOn: ExcelScript.SortOn.value\n  }\n  databaseTable.getSort().apply([severitySort])//sort by severity\n}","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}