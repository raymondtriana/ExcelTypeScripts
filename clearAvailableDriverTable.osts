{"version":"0.2.0","body":"/*\nAUTHOR: Raymond Levi Triana\nPURPOSE: Clears the table in the Driver Availability Excel File\n    This is automated to run every Friday at 11:59PM via Microsoft Power Automate\nDATE: 10/04/2022\n*/\n//Date.getday() 0-6[sun-sat]\nvar tableRef: ExcelScript.Table\nvar tableRange: ExcelScript.Range\n\nfunction main(workbook: ExcelScript.Workbook) {\n    tableRef = workbook.getTable(\"AvailableTable\")\n    if (tableRef) {//check if table ptr is valid\n        tableRange = tableRef.getRangeBetweenHeaderAndTotal()\n        //clear the table of all data\n        clearTable(workbook)\n        //auto-populate the table\n        updateDateColumn(workbook)\n    } else {\n        console.log(\"tableRef IS NOT VALID\")\n        return;\n    }\n}\n\nfunction clearTable(workbook:ExcelScript.Workbook){\n    //clears the table cells B2:J7\n    //resize the range to exclude first col and last row\n    tableRange = tableRange.getOffsetRange(0,1)//move top-left corner of range\n    tableRange = tableRange.getResizedRange(-1,-1)//move bot-right corner of range\n    //deleteRange = deleteRange.getResizedRange(0,-1)\n    let deleteRange = tableRange\n    deleteRange = deleteRange.getOffsetRange(0,1)\n    deleteRange = deleteRange.getResizedRange(0,-2)\n    deleteRange.clear()\n    //deleteRange.getResizedRange(0,-1).clear()\n    /*for(var row = 0; row < tableRange.getRowCount()-1; row++){\n        for(var col = 1; col < tableRange.getColumnCount(); col++){\n        }\n    }*/\n}\n\nfunction updateDateColumn(workbook:ExcelScript.Workbook){\n    //auto updates the date column of the table to the next week\n    /* \n    On friday:\n      getDay() = 5\n    */\n\n\n    var today: Date = new Date(Date.now())\n    today.setDate(today.getDate()+(7-today.getDay()))//offset to the next week\n    today.setDate(today.getDate() - today.getDay())//shifts the date back to sunday[unnecessary leftover but y delete?]\n    for(var i  = 0; i < 6; i++){//loop through the dates of the week\n        today.setDate(today.getDate()+1)//shift today to the next day of the week\n        tableRange.getCell(i,0).setValue(today.toLocaleDateString())//set dates\n    }\n}\n","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}