{"version":"0.2.0","body":"/*\n=LET(\nmonday,TEXT(VALUE($X$2),\"dd\"),\nmonth,TEXT(VALUE($X$2),\"mm\"),\nyear,TEXT(VALUE($X$2),\"yyyy\"),\nTERM,TEXT(VALUE($B5),\"General\"),\nCOL,10,\nLINK,'https://cheneybrothers.sharepoint.com/sites/OcalaOperations/Shared Documents/Dispatch/PicScan/Archive/2023/01/[01-30-2023.xlsx]PicScan'!$A$1:$K$255,\nSEARCH,'https://cheneybrothers.sharepoint.com/sites/OcalaOperations/Shared Documents/Dispatch/PicScan/Archive/2023/01/[01-30-2023.xlsx]PicScan'!$A:$A,\nINDEX(LINK,MATCH(TERM,SEARCH,0),COL)\n)\n*/\nvar formula_0:string;\nvar formula_1:string;\nvar workbook:ExcelScript.Workbook\nvar sheet:ExcelScript.Worksheet\nvar monday_0:string[]\nvar monday_1:string[]\nfunction main(workbook: ExcelScript.Workbook) {\n    // Your code here\n    init_script(workbook);\n    paste_formulas();\n}\n\nfunction init_script(workbook:ExcelScript.Workbook){\n  this.workbook = workbook;\n  sheet = workbook.getWorksheet(\"ROUTES\")\n\n  unprotect_sheet()\n\n  monday_0 = sheet.getCell( 1 , 10 ).getText().split(\"/\")\n\n  if(monday_0[0].length==1)\n    monday_0[0] = \"0\"+monday_0[0]\n\n  if (monday_0[1].length == 1)\n    monday_0[1] = \"0\" + monday_0[1]\n\n  monday_1 = sheet.getCell( 1 , 23 ).getText().split(\"/\")\n\n  if (monday_1[0].length == 1)\n    monday_1[0] = \"0\" + monday_1[0]\n\n  if (monday_1[1].length == 1)\n    monday_1[1] = \"0\" + monday_1[1]\n  \n  protect_sheet()\n\n//='https://cheneybrothers.sharepoint.com/sites/Dispatch/Shared Documents/Reports/PicScan/Archive/2023/03/[03-13-2023.xlsx]PicScan'!$A$3\n\n  formula_0 = \"=LET(\\n\"+\n              \"TERM, $B5,\\n\"+\n              \"COL, 7,\\n\"+\n              \"LINK, 'https://cheneybrothers.sharepoint.com/sites/Dispatch/Shared Documents/Reports/PicScan/Archive/\"+monday_0[2]+\"/\"+monday_0[0]+\"/[\"+monday_0[0]+\"-\"+monday_0[1]+\"-\"+monday_0[2]+\".xlsx]PicScan'!$A$1:$K$255,\\n\"+\n    \"SEARCH,'https://cheneybrothers.sharepoint.com/sites/Dispatch/Shared Documents/Reports/PicScan/Archive/\" + monday_0[2] + \"/\" + monday_0[0] + \"/[\" + monday_0[0] + \"-\" + monday_0[1] + \"-\" + monday_0[2] +\".xlsx]PicScan'!$A:$A,\\n\"+\n              \"INDEX(LINK, MATCH(TERM, SEARCH, 0), COL)\\n\"+\n              \")\"\n\n  formula_1 = \"=LET(\\n\" +\n    \"TERM, $B5,\\n\" +\n    \"COL, 7,\\n\" +\n    \"LINK, 'https://cheneybrothers.sharepoint.com/sites/Dispatch/Shared Documents/Reports/PicScan/Archive/\" + monday_1[2] + \"/\" + monday_1[0] + \"/[\" + monday_1[0] + \"-\" + monday_1[1] + \"-\" + monday_1[2] + \".xlsx]PicScan'!$A$1:$K$255,\\n\" +\n    \"SEARCH,'https://cheneybrothers.sharepoint.com/sites/Dispatch/Shared Documents/Reports/PicScan/Archive/\" + monday_1[2] + \"/\" + monday_1[0] + \"/[\" + monday_1[0] + \"-\" + monday_1[1] + \"-\" + monday_1[2] + \".xlsx]PicScan'!$A:$A,\\n\" +\n    \"INDEX(LINK, MATCH(TERM, SEARCH, 0), COL)\\n\" +\n    \")\"\n\n\n}\n\nfunction paste_formulas(){\n  unprotect_sheet()\n\n  sheet.getRange(\"G5:G255\").clear(ExcelScript.ClearApplyTo.contents)\n  sheet.getRange(\"G5\").getCell(0,0).setValue(formula_0)\n  sheet.getRange(\"G6:G255\").copyFrom(sheet.getRange(\"G5\"))\n\n  sheet.getRange(\"T5:T255\").clear(ExcelScript.ClearApplyTo.contents)\n  sheet.getRange(\"T5\").getCell(0, 0).setValue(formula_1)\n  sheet.getRange(\"T6:T255\").copyFrom(sheet.getRange(\"T5\"))\n\n  protect_sheet()\n}\n\nfunction unprotect_sheet(){\n  sheet.getProtection().unprotect(\"0263\")\n\n}\n\nfunction protect_sheet(){\n  var options:ExcelScript.WorksheetProtectionOptions\n  sheet.getProtection().protect(options,\"0263\")\n}","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}